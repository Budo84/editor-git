<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proflama Webmaster Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        body { background-color: #f8fafc; color: #334155; }
        .tool-card { display: none; }
        .tool-card.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .btn-nav { @apply px-4 py-2 rounded-lg font-bold text-sm transition-all; }
        .btn-nav.active { @apply bg-blue-600 text-white shadow-md; }
        .btn-nav:not(.active) { @apply bg-white text-gray-600 hover:bg-gray-100; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-10 px-4 relative">

    <a href="index.html" class="absolute top-4 left-4 bg-white text-blue-600 px-4 py-2 rounded-lg shadow font-bold text-sm border border-blue-100 hover:bg-blue-50 transition no-underline flex items-center gap-2 z-20">
        ‚¨ÖÔ∏è <span class="hidden sm:inline">Torna all'Editor</span>
    </a>

    <header class="text-center mb-10 mt-8">
        <h1 class="text-3xl font-black text-slate-800 mb-2">üõ†Ô∏è Webmaster Tools</h1>
        <p class="text-slate-500">Strumenti per gestire il blog Proflama</p>
    </header>

    <div class="flex flex-wrap justify-center gap-2 mb-8 bg-gray-200 p-1.5 rounded-xl">
        <button onclick="switchTab('img')" class="btn-nav active" id="btn-img">üñºÔ∏è Immagini WebP</button>
        <button onclick="switchTab('icon')" class="btn-nav" id="btn-icon">üì± Genera Icone</button>
        <button onclick="switchTab('meta')" class="btn-nav" id="btn-meta">üìù Metadata Post</button>
    </div>

    <div id="tab-img" class="tool-card active w-full max-w-2xl bg-white p-8 rounded-2xl shadow-xl border border-slate-100">
        <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
            <span class="bg-blue-100 text-blue-600 p-2 rounded-lg">üñºÔ∏è</span> Ottimizzatore Immagini
        </h2>
        <p class="text-sm text-gray-500 mb-6">Converte JPG/PNG in <b>WebP</b> (leggero per il sito) e ridimensiona.</p>

        <div class="space-y-4">
            <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:bg-blue-50 transition cursor-pointer relative">
                <input type="file" id="img-input" accept="image/*" class="absolute inset-0 opacity-0 cursor-pointer" onchange="previewImage()">
                <div id="img-placeholder">
                    <div class="text-4xl mb-2">üìÇ</div>
                    <span class="font-bold text-gray-400">Clicca o trascina qui un'immagine</span>
                </div>
                <img id="img-preview" class="max-h-64 mx-auto hidden rounded shadow-sm">
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-xs font-bold text-gray-400 uppercase">Larghezza Max (px)</label>
                    <input type="number" id="img-width" value="1200" class="w-full border rounded px-3 py-2 font-mono text-sm">
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-400 uppercase">Qualit√† (0-100)</label>
                    <input type="number" id="img-quality" value="80" class="w-full border rounded px-3 py-2 font-mono text-sm">
                </div>
            </div>

            <button onclick="processImage()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl shadow-lg transition">
                ‚ö° Scarica WebP Ottimizzata
            </button>
        </div>
    </div>

    <div id="tab-icon" class="tool-card w-full max-w-2xl bg-white p-8 rounded-2xl shadow-xl border border-slate-100">
        <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
            <span class="bg-purple-100 text-purple-600 p-2 rounded-lg">üì±</span> Generatore Icone App
        </h2>
        <p class="text-sm text-gray-500 mb-6">Carica un logo quadrato. Crea ZIP con icone per il sito e Manifest.</p>

        <div class="space-y-4">
            <input type="file" id="icon-input" accept="image/*" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100"/>
            <button onclick="generateIcons()" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 rounded-xl shadow-lg transition">
                üì¶ Genera e Scarica ZIP
            </button>
        </div>
    </div>

    <div id="tab-meta" class="tool-card w-full max-w-2xl bg-white p-8 rounded-2xl shadow-xl border border-slate-100">
        <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
            <span class="bg-emerald-100 text-emerald-600 p-2 rounded-lg">üìù</span> Helper Intestazione
        </h2>
        <div class="grid gap-4">
            <div>
                <label class="text-xs font-bold text-gray-400 uppercase">Titolo</label>
                <input type="text" id="meta-title" placeholder="Titolo" class="w-full border rounded px-3 py-2" oninput="updateMeta()">
            </div>
            <div>
                <label class="text-xs font-bold text-gray-400 uppercase">Descrizione</label>
                <textarea id="meta-desc" rows="2" placeholder="Descrizione (per Google)..." class="w-full border rounded px-3 py-2" oninput="updateMeta()"></textarea>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-xs font-bold text-gray-400 uppercase">Categoria</label>
                    <select id="meta-cat" class="w-full border rounded px-3 py-2" onchange="updateMeta()">
                        <option>Arduino</option>
                        <option>Microbit</option>
                        <option>Elettronica</option>
                        <option>Blog</option>
                    </select>
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-400 uppercase">Data</label>
                    <input type="date" id="meta-date" class="w-full border rounded px-3 py-2" onchange="updateMeta()">
                </div>
            </div>
            <div class="bg-gray-800 text-gray-300 p-4 rounded-xl font-mono text-sm relative mt-4">
                <button onclick="copyMeta()" class="absolute top-2 right-2 bg-gray-600 hover:bg-gray-500 text-white px-2 py-1 text-xs rounded">Copia</button>
                <pre id="meta-output">---...---</pre>
            </div>
        </div>
    </div>

    <script>
        function switchTab(t) {
            document.querySelectorAll('.tool-card, .btn-nav').forEach(e => e.classList.remove('active'));
            document.getElementById('tab-'+t).classList.add('active');
            document.getElementById('btn-'+t).classList.add('active');
        }

        // IMG Logic
        function previewImage() {
            const f = document.getElementById('img-input').files[0];
            if(f) {
                document.getElementById('img-preview').src = URL.createObjectURL(f);
                document.getElementById('img-preview').classList.remove('hidden');
                document.getElementById('img-placeholder').classList.add('hidden');
            }
        }
        function processImage() {
            const f = document.getElementById('img-input').files[0];
            if(!f) return alert("Scegli immagine");
            const mw = parseInt(document.getElementById('img-width').value);
            const q = parseInt(document.getElementById('img-quality').value)/100;
            const r = new FileReader();
            r.onload = e => {
                const i = new Image();
                i.onload = () => {
                    const c = document.createElement('canvas');
                    let w=i.width, h=i.height;
                    if(w>mw) { h*=mw/w; w=mw; }
                    c.width=w; c.height=h;
                    c.getContext('2d').drawImage(i,0,0,w,h);
                    c.toBlob(b => saveAs(b, f.name.split('.')[0]+"_opt.webp"), 'image/webp', q);
                };
                i.src = e.target.result;
            };
            r.readAsDataURL(f);
        }

        // Icon Logic
        function generateIcons() {
            const f = document.getElementById('icon-input').files[0];
            if(!f) return alert("Carica logo");
            const sizes = [{w:192,n:"web-app-manifest-192x192.png"},{w:512,n:"web-app-manifest-512x512.png"},{w:180,n:"apple-touch-icon.png"},{w:32,n:"favicon.ico"}];
            const z = new JSZip();
            const r = new FileReader();
            r.onload = e => {
                const i = new Image();
                i.onload = () => {
                    let p=0;
                    const fol = z.folder("icons_generated");
                    sizes.forEach(s => {
                        const c = document.createElement('canvas');
                        c.width=s.w; c.height=s.w;
                        c.getContext('2d').drawImage(i,0,0,s.w,s.w);
                        c.toBlob(b => {
                            fol.file(s.n, b);
                            p++;
                            if(p===sizes.length) z.generateAsync({type:"blob"}).then(c => saveAs(c,"icons.zip"));
                        }, 'image/png');
                    });
                };
                i.src = e.target.result;
            };
            r.readAsDataURL(f);
        }

        // Meta Logic
        document.getElementById('meta-date').valueAsDate = new Date();
        function updateMeta() {
            const t = `---
title: ${document.getElementById('meta-title').value}
description: ${document.getElementById('meta-desc').value}
date: ${document.getElementById('meta-date').value}
category: ${document.getElementById('meta-cat').value}
class_target: Tutti
image: /img/default.jpg
---`;
            document.getElementById('meta-output').innerText = t;
        }
        function copyMeta() { navigator.clipboard.writeText(document.getElementById('meta-output').innerText); alert("Copiato!"); }
        updateMeta();
    </script>
</body>
</html>
